FROM nvcr.io/nvidia/pytorch:24.03-py3

# Copy CARLA Python API egg from the simulator image
COPY --from=carlasim/carla:0.9.15 /home/carla/PythonAPI/carla/dist/carla-0.9.15-py3.7-linux-x86_64.egg /tmp/

# Install the CARLA egg
RUN pip install --no-deps --find-links=/tmp carla

# Install any additional dependencies (fail-safe)
COPY requirements.txt /tmp/
RUN pip install --no-cache-dir -r /tmp/requirements.txt || true

WORKDIR /app
